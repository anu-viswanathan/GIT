<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Claim_Stages_Cannot_move_Backwards</fullName>
    <active>true</active>
    <description>The Claim Stages cannot move backwards in a claim. The exception for this is a Sys Admin, IKO Power User and Claims Manager can move items backwoards, except for Closed Stage.This validation rule only applies to Commercial and Residential Claims</description>
    <errorConditionFormula>AND (OR(
RecordType.DeveloperName = &apos;Commercial_Claim&apos;,
RecordType.DeveloperName = &apos;Residential_Claim&apos;
),
IF(
    AND(
		TEXT(Claim_Stage__c) &lt;&gt; &apos;Closed&apos;,
		TEXT(PRIORVALUE(Claim_Stage__c)) = &apos;Closed&apos;
	),
	IF(
		OR(
			ISBLANK(Re_Open_Details__c),
			ISBLANK(TEXT(Re_Open_Reason__c))
		),
		true,
		false
	),
	IF(
		AND(
			$Profile.Name &lt;&gt; &quot;System Administrator&quot;,
			$Profile.Name &lt;&gt; &quot;IKO Power User&quot;,
			$Profile.Name &lt;&gt; &quot;Claims Manager&quot;
		),
		CASE(
			Claim_Stage__c ,
			&quot;Draft&quot;, 1,
			&quot;Submitted&quot;, 2,
			&quot;Awaiting Docs&quot;, 3,
			&quot;In Kankakee&quot;, 4,
			&quot;In Lab&quot;, 5,
			&quot;File Preparation&quot;, 6,
			&quot;Assessment&quot;, 7,
			&quot;Offered&quot;, 8,
			&quot;Payment&quot;, 9,
			&quot;Closed&quot;, 10,
			0
		) &lt;
			CASE(
				PRIORVALUE(Claim_Stage__c),
				&quot;Draft&quot;, 1,
				&quot;Submitted&quot;, 2,
				&quot;Awaiting Docs&quot;, 3,
				&quot;In Kankakee&quot;, 4,
				&quot;In Lab&quot;, 5,
				&quot;File Preparation&quot;, 6,
				&quot;Assessment&quot;, 7,
				&quot;Offered&quot;, 8,
				&quot;Payment&quot;, 9,
				&quot;Closed&quot;, 10,
				0
			),
		false
	)
)
)</errorConditionFormula>
    <errorDisplayField>Claim_Stage__c</errorDisplayField>
    <errorMessage>You cannot move the Claim Stage from the current Stage to a previous Stage.</errorMessage>
</ValidationRule>
