<?xml version="1.0" encoding="UTF-8"?>
<ValidationRule xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>Lock_Case_After_its_Closed</fullName>
    <active>true</active>
    <description>Lock all fields when a claim is closed so that no changes can be made. 
This validation rule only applies to Commercial and Residential Claims.
     2019-11-28 Activated as per CLAIMSV2-288</description>
    <errorConditionFormula>AND(
ISPICKVAL(Claim_Stage__c, &quot;Closed&quot;),
OR (
    $Profile.Name &lt;&gt; &quot;System Administrator&quot;,
    $Profile.Name &lt;&gt; &quot;Claims Manager&quot;
    ),
	NOT(ISCHANGED(Re_Open_Reason__c)),
	NOT(ISCHANGED(Re_Open_Details__c)),
        PRIORVALUE(Claim_Stage__c) = &quot;Closed&quot;,
OR(
    RecordType.DeveloperName = &apos;Commercial_Claim&apos;,
    RecordType.DeveloperName = &apos;Residential_Claim&apos;
	   )
)</errorConditionFormula>
    <errorMessage>This case has been closed and cannot be edited.</errorMessage>
</ValidationRule>
